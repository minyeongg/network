# 8.1 개요
## 8.1.1 일반적 개념

유니캐스트 라우팅에서, 출발지에서 도착지까지 포워딩 테이블을 참조하여 홉 단위로 라우팅 됨.<br>
컴퓨터는 자신에게 붙은 라우터가 일반적으로 하나임. -> 출발지 호스트는 자신이 속한 네트워크의 디폴트 라우터에게 패킷을 전달하면 되므로 포워딩 테이블이 불필요함. 단, 호스트가 여러 네트워크에 동시에 연결된 경우에는 포워딩 테이블이 필요함.<br>
목적지 호스트도 자신이 속한 라우터로부터 패킷을 수신하므로 포워딩 테이블 불필요. 단, 목적지 호스트가 여러 네트워크에 동시에 연결된 경우에는, 응답 데이터를 보낼 때 포워딩 테이블이 필요함.<br>
라우터들은 포워딩 테이블이 필요함.<br>

## 8.1.2 최소비용 라우팅 ---> 다시 제대로 이해하기

인터넷을 가중 그래프로 표시하면, 출발 라우터로부터 도착 라우터로의 가장 좋은 경로는, 둘 사이의 최소 비용 경로<br>
즉, 이 라우팅 방법에서는 여러 가능 경로 중에서 비용이 최소가 되는 경로를 선택<br>
그래프 표현 : 라우터를 노드, 링크를 간선으로 표현.<br>
각 노드마다 자신을 루트로 하는 트리를 만들어서 그것을 가지고 목적지까지 가는 경로를 찾음.<br>

## 8.2 라우팅 알고리즘

라우팅 알고리즘들은 최소 비용의 해석, 최소 비용 트리를 만드는 방법에서 차이가 남. 따라서 이 절에서는 공통 알고리즘을 논의하고, 인터넷의 라우팅 프로토콜이 이들 중의 한 알고리즘을 어떻게 구현했는지 고찰<br>

### 8.2.1 거리-벡터 라우팅

- 거리-벡터(DV) : 방향과 거리 값<br>
- 최적의 경로 탐색 : 각 노드는 자신의 이웃 정보를 통해 최소 비용 트리 생성 -> 단순, 불완전한 정보. 이 정보를 이웃 노드들과 교환하며 변화되는 것들을 업데이트함<br>
- 거리-벡터 라우팅에서, 각 라우터는 계속 이웃 노드들에게 자신이 알고있는(미완) 정보를 끊임없이 교환함. -> 정확한 라우팅 테이블을 만들게 됨<br>
- 벨만-포드 공식: 최소 비용 경로를 찾는 공식.<br><br>

새로운 중간노드 z을 알았을 때 공식의 업데이트<br>

- 벨만-포드 공식의 그래프적 개념<br>
- 트리의 거리-벡터 값<br>
- 거리-벡터값 업데이트<br>
- 두 노드의 불안정성 :<br>---> ppt 17p, 강의 설명 다시 듣기
  보통 16이라는 것은 도달할 수 없다는 걸 의미함. A는 업데이트 했는데 B는 업데이트가 안된 상태도 있음.<br>
  A가 다시 B를 통해 업데이트될 수도 있음. -> 루프를 형성하게 됨.<br>
  결국 둘다 무한대가 되어 버리게 되는데<br>
  이 상태에 도달할 때까지 굉장히 많은 시간이 걸림(불안정한 상태를 지속하게 됨.)<br>

### 8.2.2 링크 상태 라우팅

- 링크의 특성을 결정하기 위해 링크 상태 사용<br>
- 비용은 링크의 상태를 정의한 엣지로 구성됨<br>
- 저비용의 링크 선호 <br>
- 최소 비용 트리를 만들려면 전체 네트워크의 지도가 필요.<br>
  즉, 모든 라우터의 링크 비용을 알아야함.<br>
- Link-state database(LSDB) : 모든 링크 상태의 집합<br>
- 링크-상태 데이터베이스의 예<br>
  a. 가중치 그래프<br>
  b. 링크 상태 데이터베이스 (간선들의 가중치를 정리한 이차원 배열)<br><br>

- 다익스트라 알고리즘:<br>
  LSDB로부터 최소비용트리 생성<br>
  단계:<br>

1. 루트 노드 선정(라우터 자신). 루트 노드만 있는 트리로 시작<br>
2. 아직 트리에 없고 연결된 노드를 선택하여 트리에 추가하고, 트리 내의 모든 노드까지의 비용 업데이트<br>
   D[x] = min{D[x],(D[w] + c[w][x])}<br>
3. 모든 노드가 포함될 때까지 위 단계 수행.<br>
   최종적으로, 루트노드에서 모든 노드로의 최소비용트리 생성<br><br>

- 최소비용트리<br>

### 8.2.3 경로-벡터 라우팅

- 최소 비용이 아닌 다른 정책을 적용하는 라우팅<br>
  정책 : 특정 노드를 경유하거나 제외하거나, 방문할 최소 노드 수를 적용하는 경로<br>
- Best Spanning Tree 선정(policy 적용, 이는 최소 비용 트리가 아님.)<br>
- ISP(큰 네트워크)간의 패킷 경로를 위해 고안 -> 비용이 아닌 정책이 중요하기 때문<br>
- 거리-벡터의 벨만-포드 알고리즘과 비슷하지만, 최소비용이 아닌 정책을 반영<br>
- 라우팅 테이블 내용은 경로벡터 [x,a,b,...,c,d,y] : 거쳐야 하는 ISP들의 나열 -> 이것을 이웃노드와 교환함.<br><br>

- 스패닝 트리들 : 각 노드들은 커더란 네트워크들임. policy 예시 : C를 통과 안함, D를 통과 안함 등등<br>
- 부팅 시 만들어진 경로 벡터들<br>
- 경로 벡터 업데이트<br>
- 노드의 경로-벡터 알고리즘

# 8.3 유니캐스트 라우팅 프로토콜

- 인터넷에서 공통으로 사용되는 세가지 프로토콜 : RIP, OSPF, BGP<br>
  - RIP(라우팅 정보 프로토콜) : 거리-벡터 라우팅 알고리즘을 사용하는 프로토콜<br>
  - OSPF(Open Shortest Path First프로토콜) : 링크-상태 라우팅 알고리즘을 사용하는 프로토콜<br>
  - BGP(Border Gateway 프로토콜) : 경로-벡터 라우팅 알고리즘을 사용하는 프로토콜<br>

## 인터넷 구조

인터넷은 하나의 백본을 가진 트리구조에서, 서로 다른 사설 회사에 의해 운영되는 다수의 백본을 가진 구조로 바뀌어 옴.<br>

- 인터넷의 구조 -> ppt 32p <br> 

### 계층적 라우팅
- 인터넷에서 라우팅을 단일 프로토콜을 사용하여 수행할 수 없다는 것
### 자율 시스템 (AS)
- 각 ISP는 네트워크와 라우터를 제어할 때 자율 시스템임<br>
## 8.3.2 RIP

- RIP(라우팅 정보 프로토콜) : 거리-벡터 라우팅 알고리즘을 사용하는 프로토콜. 가장 널리 사용됨. 작은 도메인들이 모여서 큰 네트워크, 그것들이 모여서 인터넷이 되는데, 도메인 내에서 라우터들이 사용하는 프로토콜임.<br><br>

- RIP에서의 홉 카운트 --> ppt 36p <br>
  RIP에서의 비용은 몇개의 홉을 거치는가임.<br><br>

- 각 라우터의 포워딩 테이블<br>
  바로 연결된 노드는 비용이 1<br><br>

- RIP 메시지 포맷<br>
  주변의 라우터와 라우팅 정보를 공유할 때 메시지를 사용함.<br><br>

- AS(autonomous system, 자동화 시스템)내에서의 사용

## 8.3.3 OSPF

- OSPF도 RIP와 같이 도메인 내 라우팅 프로토콜<br>
- 링크-상태 라우팅 알고리즘을 사용하는 프로토콜<br>
- 공개 프로토콜로 누구든지 구현해서 사용할 수 있음<br>

### OSPF에서의 메트릭(비용의 단위)

### OSPF에서의 포워딩 테이블

### OSPF 환경에서 AS내의 지역

OSPF는 AS내에서 사용되는 프로토콜.<br>
단, RIP와 다르게 AS가 좀 크다면 지역으로 분할함.<br>
백본 area를 area0, 주변 area는 1부터 이름을 붙임.<br>
백본에 주변 area가 연결되는 계층적인 구조임.<br>
따라서 OSPF는 계층적인 구조를 가져감으로써 RIP보다는 큰 네트워크에 적용할 수 있는 라우팅 프로토콜임<br>

## BGP

- AS 내가 아닌 도메인 간에 사용되는 프로토콜<br>
- 경로-벡터 라우팅 알고리즘을 사용하는 프로토콜<br>
  -> 네트워크 도달가능성 정보 제공에 맞춰짐<br>
- eBGP(external BGP) : AS의 경계 라우터에서 작동. 즉 AS간의 라우팅. 다른 AS와 정보 교환<br>
- iBGP(internal BGP) : AS 내에서 작동. AS 내 모든 라우터와 정보 교환. 즉, 다른 AS에서 얻은 정보를 AS 내의 라우터들에게 알려주는 것임.<br>

### 4개의 AS로 구성된 샘플 인터넷

### eBGP 동작

### 최종 BGP 경로 테이블
