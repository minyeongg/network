- 멀티캐스트 주소 :<br>
  모든 수신자를 패킷에 넣을 수는 없으므로 멀티캐스트 주소가 필요.<br>
  멀티캐스트 주소는 하나가 아닌 수신자 그룹의 주소임. 즉 그룹의 식별자임.<br>
  하나의 발신자, 그룹의 목적지<br>
- 멀티캐스트 주소의 바이너리 표현:<br>
  32비트 중 처음 4비트는 1110으로 고정되어 있음.<br>
  나머지 28비트는 그룹 식별자임.<br>
  주소의 첫 숫자가 224-239 사이면 D클래스 주소임.<br>
  블록 : 224.0.0.0/4<br>
- 데이터링크 계층에서의 전달<br>
  실제적인 통신은 프레임을 주고받으며 일어남. 프레임의 헤더에는 목적지 주소가 있음. 따라서 데이터링크 계층에서도 멀티캐스트 주소가 필요함.<br>
  D클래스 주소로부터 이더넷 주소로의 매핑:<br>
  D클래스 주소의 뒷부분 28비트 중 앞의 5비트는 버리고 23비트만
  가져와서 48비트의 이더넷 MAC 주소를 만듦.<br>
  앞의 25비트는 고정(01:00:5E:0)이고, 뒤의 23비트는 패킷에서 가져온 것.<br>
  정리하자면, 멀티캐스트 데이터를 전달하기 위해서는 D클래스 주소를 사용해서 전달하지만 실질적으로 호스트와 호스트, 호스트와 라우터, 라우터와 라우터가 통신할 때는 DL층의 프레임을 보내는데 거기서도 멀티캐스트 주소가 필요하다. 그 주소를 만들 때는 IP 계층의 주소를 가지고 만든다.<br>
  예제 6.1, 6.2<br>
  D클래스 주소가 달라도 뒷부분 세 섹션이 같으면 이더넷의 멀티캐스트 주소는 동일하게 나옴<br>
  그룹이 없는데도 받아들이게 되는 현상이 생기는데 이것은 상위계층에서 해결함.<br>
  터널링 :<br>
  대부분의 WAN은 멀티캐스트를 지원하지 않으므로 멀티캐스팅 패킷을 유니캐스팅 패킷으로 캡슐화하여 전송하는 것.<br>
- 그룹 정보 모으기(IGMP)<br>
  유니캐스트와 멀티캐스트에서 포워딩 테이블을 생성하는 2단계<br>
  1. 라우터가 자신에게 연결된 목적지를 인식 :<br>
     유니캐스트는 자동으로 알지만 멀티캐스트는 멤버들을 알게하는 방안이 필요 -> IGMP<br>
  2. 각 라우터는 위 단계에서 얻은 정보를 다른 모든 라우터에게 전달하여, 어떤 목적지가 어느 라우터에 연결되었는지를 알려줌<br>
     유니캐스트 : 네트워크 프리픽스를 다른 라우터에게 전달<br>
     멀티캐스트 : 존재하는 그룹의 정보를 다른 라우터에게 전달<br>
     유니캐스트와 멀티캐스트의 광고 비교<br>
- 멀티캐스트 포워딩<br>
  유니캐스트와 다른 점:<br>
  1. 전달 경로 수<br>
  2. 포워딩 결정 시 참조 정보: 유니캐스트의 경우 목적지 주소만 보고 결정. 멀티캐스트의 경우 소스, 목적지 주소 둘 다 보고 결정<br>
     만약 소스이자 그룹멤버이면 한쪽으로만 데이터를 보내기도 함. 그렇기 때문에 멀티캐스트는 소스가 누구냐에 따라 데이터가 전달되는 경로가 다를 수 있다.

### 그룹 공유 트리

- m 그룹 당 1개의 트리 : m개<br>
- designated(코어, 랑데뷰포인트) 라우터를 루트로 하는 트리<br>
- 멀티캐스트를 보내려는 소스가, 랑데뷰포인트로 전달(유니캐스트로) 후, 멀티캐스팅<br>
- 코어 라우터 선정 알고리즘 필요<br>

## inter-domain protocol(도메인 간에 쓰이는 프로토콜)

- AS(Autonomous System)간에 쓰이는 프로토콜<br>
- MBGP(Multicast border gateway protocol, BGP의 확장) 혹은 BGMP(Border Gateway Multicast Protocol) 를 사용해서 구현함<br>

## 8.5 IGMP

- 라우터들이 자신의 네트워크 안에 그룹 멤버가 있는지 없는지를 파악하는 데 사용하는 프로토콜<br>

### 8.5.1 메시지

- 요청과 응답은 IP 패킷에 캡슐화되어 전달됨<br>
- IGMPv3 메시지:<br>
  Query 메시지:<br>
  라우터가 네트워크 내의 모든 호스트에게 주기적으로 보내는 것으로, 특정 그룹의 멤버가 있는지를 확인함.<br>
  General/ Group-specific / Source-and-group-specific<br>
  각각 모든 멀티태스크 그룹 멤버 정보 / 특정 그룹 멤버 정보 / 특정 그룹의 특정 소스 정보를 원할 때 보냄.<br>
  Report 메시지:<br>
  호스트가 query 메시지에 대해서 응답하는 것<br>
  그룹 주소 레코드 (자신이 어떤 그룹의 멤버인지)의 리스트 포함<br>
- 캡슐화<br>
  페이로드 부분에 IGMP 메시지가 들어감.<br>
  프로토콜 필드값이 2인 경우가 IGMP 메시지임.<br>
  TTL 필드값 1 : 라우터를 거칠 때마다 하나씩 줄이고 0 이되면 폐기하는 데 1이라는 것은 현재 네트워크 내에서만 전파하는 것. 즉 IGMP 메시지는 TTL이 1임.<br>
  요청, 응답 등 메시지 유형마다 패킷의 목적지 주소값이 있음.<br>
